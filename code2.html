<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gạch Cao Cấp - Chất Lượng Vượt Trội</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.waves.min.js"></script>
    <style>
        .hero-bg {
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('http://static.photos/construction/1200x630/5');
            background-size: cover;
            background-position: center;
        }
        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .testimonial-card {
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
        }
        .user-info-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: #fca5a5;
            color: white;
            padding: 8px;
            text-align: center;
            font-size: 0.8rem;
            z-index: 1000;
        }
    </style>
</head>
<body class="font-sans bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-6 py-3">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4">
                    <i data-feather="box" class="text-red-600"></i>
                    <span class="font-bold text-xl text-gray-800">GẠCH VIP</span>
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="#" class="text-red-600 font-medium">Trang chủ</a>
                    <a href="#products" class="text-gray-600 hover:text-red-600">Sản phẩm</a>
                    <a href="#about" class="text-gray-600 hover:text-red-600">Về chúng tôi</a>
                    <a href="#testimonials" class="text-gray-600 hover:text-red-600">Đánh giá</a>
                    <a href="#contact" class="text-gray-600 hover:text-red-600">Liên hệ</a>
                    <a href="#add-product" class="text-red-600 border border-red-600 rounded-lg px-4 py-2 hover:bg-red-600 hover:text-white transition duration-300">Thêm sản phẩm</a>
                </div>
                <div class="md:hidden">
                    <button class="mobile-menu-button">
                        <i data-feather="menu"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- User Info Bar -->
    <div id="user-info-bar" class="user-info-bar hidden">
        <span id="user-id-display"></span>
    </div>

    <!-- Hero Section -->
    <section class="hero-bg text-white py-20">
        <div class="container mx-auto px-6 text-center" data-aos="fade-up">
            <h1 class="text-4xl md:text-6xl font-bold mb-6">GẠCH CAO CẤP CHO NGÔI NHÀ CỦA BẠN</h1>
            <p class="text-xl md:text-2xl mb-8">Chất lượng vượt trội - Thiết kế đẳng cấp - Bền vững với thời gian</p>
            <div class="flex justify-center space-x-4">
                <a href="#products" class="bg-red-600 hover:bg-red-700 text-white px-8 py-3 rounded-lg font-medium transition duration-300">Xem sản phẩm</a>
                <a href="#contact" class="bg-white hover:bg-gray-100 text-red-600 px-8 py-3 rounded-lg font-medium transition duration-300">Liên hệ ngay</a>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="py-16 bg-white">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16" data-aos="fade-up">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">TẠI SAO CHỌN GẠCH CỦA CHÚNG TÔI?</h2>
                <div class="w-24 h-1 bg-red-600 mx-auto"></div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-10">
                <div class="text-center p-6" data-aos="fade-up" data-aos-delay="100">
                    <div class="bg-red-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i data-feather="shield" class="text-red-600 w-10 h-10"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">Chất lượng cao</h3>
                    <p class="text-gray-600">Sản phẩm được sản xuất trên dây chuyền hiện đại, đạt tiêu chuẩn quốc tế về độ bền và an toàn.</p>
                </div>
                <div class="text-center p-6" data-aos="fade-up" data-aos-delay="200">
                    <div class="bg-red-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i data-feather="award" class="text-red-600 w-10 h-10"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">Thiết kế đa dạng</h3>
                    <p class="text-gray-600">Hàng trăm mẫu mã đẹp, phong phú phù hợp với mọi phong cách kiến trúc từ c cổ điển đến hiện đại.</p>
                </div>
                <div class="text-center p-6" data-aos="fade-up" data-aos-delay="300">
                    <div class="bg-red-100 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i data-feather="truck" class="text-red-600 w-10 h-10"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-3">Giao hàng tận nơi</h3>
                    <p class="text-gray-600">Miễn phí vận chuyển trong bán kính 50km, hỗ trợ bốc xếp và vận chuyển lên tầng.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Add Product Section -->
    <section id="add-product" class="py-16 bg-gray-50">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16" data-aos="fade-up">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">THÊM SẢN PHẨM MỚI</h2>
                <div class="w-24 h-1 bg-red-600 mx-auto"></div>
            </div>
            <div class="max-w-xl mx-auto bg-white p-8 rounded-lg shadow-md" data-aos="fade-up">
                <form id="add-product-form" class="space-y-6">
                    <div>
                        <label for="productName" class="block text-gray-700 font-medium mb-2">Tên sản phẩm</label>
                        <input type="text" id="productName" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600">
                    </div>
                    <div>
                        <label for="productDesc" class="block text-gray-700 font-medium mb-2">Mô tả</label>
                        <textarea id="productDesc" rows="3" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600"></textarea>
                    </div>
                    <div>
                        <label for="productPrice" class="block text-gray-700 font-medium mb-2">Giá (đồng/m²)</label>
                        <input type="number" id="productPrice" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600">
                    </div>
                    <div>
                        <label for="productImage" class="block text-gray-700 font-medium mb-2">URL hình ảnh</label>
                        <input type="url" id="productImage" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600">
                    </div>
                    <button type="submit" class="w-full bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-medium transition duration-300">THÊM SẢN PHẨM</button>
                    <div id="message-box" class="mt-4 text-center hidden"></div>
                </form>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section id="products" class="py-16 bg-gray-50">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16" data-aos="fade-up">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">SẢN PHẨM NỔI BẬT</h2>
                <div class="w-24 h-1 bg-red-600 mx-auto"></div>
            </div>
            <div id="products-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Products will be dynamically generated here -->
            </div>
        </div>
    </section>
    
    <!-- About Section -->
    <section id="about" class="py-16 bg-white">
        <div class="container mx-auto px-6">
            <div class="flex flex-col md:flex-row items-center">
                <div class="md:w-1/2 mb-10 md:mb-0" data-aos="fade-right">
                    <img src="http://static.photos/construction/640x360/4" alt="Về chúng tôi" class="rounded-lg shadow-xl w-full">
                </div>
                <div class="md:w-1/2 md:pl-12" data-aos="fade-left">
                    <h2 class="text-3xl font-bold text-gray-800 mb-6">VỀ CÔNG TY CHÚNG TÔI</h2>
                    <p class="text-gray-600 mb-4">Với hơn 15 năm kinh nghiệm trong lĩnh vực sản xuất và phân phối gạch ốp lát, chúng tôi tự hào là đơn vị tiên phong mang đến những sản phẩm chất lượng cao với giá cả cạnh tranh nhất thị trường.</p>
                    <p class="text-gray-600 mb-6">Đội ngũ chuyên gia giàu kinh nghiệm cùng hệ thống máy móc hiện đại nhập khẩu từ châu Âu giúp chúng tôi không ngừng cải tiến chất lượng sản phẩm và đa dạng hóa mẫu mã đáp ứng mọi nhu cầu của khách hàng.</p>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="flex items-center">
                            <i data-feather="check-circle" class="text-green-500 mr-2"></i>
                            <span class="text-gray-700">15+ năm kinh nghiệm</span>
                        </div>
                        <div class="flex items-center">
                            <i data-feather="check-circle" class="text-green-500 mr-2"></i>
                            <span class="text-gray-700">1000+ dự án</span>
                        </div>
                        <div class="flex items-center">
                            <i data-feather="check-circle" class="text-green-500 mr-2"></i>
                            <span class="text-gray-700">500+ mẫu mã</span>
                        </div>
                        <div class="flex items-center">
                            <i data-feather="check-circle" class="text-green-500 mr-2"></i>
                            <span class="text-gray-700">50.000+ khách hàng</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section id="testimonials" class="py-16 bg-gray-50">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16" data-aos="fade-up">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">KHÁCH HÀNG NÓI VỀ CHÚNG TÔI</h2>
                <div class="w-24 h-1 bg-red-600 mx-auto"></div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="testimonial-card p-8 rounded-lg shadow-md" data-aos="fade-up" data-aos-delay="100">
                    <div class="flex items-center mb-4">
                        <img src="http://static.photos/people/200x200/1" alt="Khách hàng" class="w-12 h-12 rounded-full mr-4">
                        <div>
                            <h4 class="font-semibold">Anh Nguyễn Văn A</h4>
                            <div class="flex text-yellow-400">
                                <i data-feather="star" class="w-4 h-4 fill-current"></i>
                                <i data-feather="star" class="w-4 h-4 fill-current"></i>
                                <i data-feather="star" class="w-4 h-4 fill-current"></i>
                                <i data-feather="star" class="w-4 h-4 fill-current"></i>
                                <i data-feather="star" class="w-4 h-4 fill-current"></i>
                            </div>
                        </div>
                    </div>
                    <p class="text-gray-600 italic">"Gạch chất lượng rất tốt, màu sắc đẹp như hình. Nhân viên tư vấn nhiệt tình, giao hàng đúng hẹn. Tôi rất hài lòng và sẽ giới thiệu cho bạn bè."</p>
                </div>
                <div class="testimonial-card p-8 rounded-lg shadow-md" data-aos="fade-up" data-aos-delay="200">
                    <div class="flex items-center mb-4">
                        <img src="http://static.photos/people/200x200/2" alt="Khách hàng" class="w-12 h-12 rounded-full mr-4">
                        <div>
                            <h4 class="font-semibold">Chị Trần Thị B</h4>
                            <div class="flex text-yellow-400">
                                <i data-feather="star" class="w-4 h-4 fill-current"></i>
                                <i data-feather="star" class="w-4 h-4 fill-current"></i>
                                <i data-feather="star" class="w-4 h-4 fill-current"></i>
                                <i data-feather="star" class="w-4 h-4 fill-current"></i>
                                <i data-feather="star" class="w-4 h-4 fill-current"></i>
                            </div>
                        </div>
                    </div>
                    <p class="text-gray-600 italic">"Mẫu gạch 3D rất đẹp và độc đáo. Sau khi ốp xong, căn phòng trở nên sang trọng hẳn. Cảm ơn c cửa hàng đã tư vấn cho tôi mẫu gạch phù hợp."</p>
                </div>
                <div class="testimonial-card p-8 rounded-lg shadow-md" data-aos="fade-up" data-aos-delay="300">
                    <div class="flex items-center mb-4">
                        <img src="http://static.photos/people/200x200/3" alt="Khách hàng" class="w-12 h-12 rounded-full mr-4">
                        <div>
                            <h4 class="font-semibold">Anh Lê Văn C</h4>
                            <div class="flex text-yellow-400">
                                <i data-feather="star" class="w-4 h-4 fill-current"></i>
                                <i data-feather="star" class="w-4 h-4 fill-current"></i>
                                <i data-feather="star" class="w-4 h-4 fill-current"></i>
                                <i data-feather="star" class="w-4 h-4 fill-current"></i>
                                <i data-feather="star" class="w-4 h-4"></i>
                            </div>
                        </div>
                    </div>
                    <p class="text-gray-600 italic">"Tôi mua gạch để lát sân vườn, sau 2 năm sử dụng vẫn như mới, không bị bong tróc hay phai màu. Dịch vụ hậu mãi cũng rất tốt."</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="py-16 bg-white">
        <div class="container mx-auto px-6">
            <div class="text-center mb-16" data-aos="fade-up">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">LIÊN HỆ VỚI CHÚNG TÔI</h2>
                <div class="w-24 h-1 bg-red-600 mx-auto"></div>
            </div>
            <div class="flex flex-col md:flex-row">
                <div class="md:w-1/2 mb-10 md:mb-0" data-aos="fade-right">
                    <div class="bg-gray-100 p-8 rounded-lg">
                        <h3 class="text-xl font-semibold mb-6">THÔNG TIN LIÊN HỆ</h3>
                        <div class="space-y-4">
                            <div class="flex items-start">
                                <i data-feather="map-pin" class="text-red-600 mr-4 mt-1"></i>
                                <div>
                                    <h4 class="font-medium">Địa chỉ:</h4>
                                    <p class="text-gray-600">107 Đ. Tam Bình, Tam Phú, Thủ Đức, Hồ Chí Minh</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <i data-feather="phone" class="text-red-600 mr-4 mt-1"></i>
                                <div>
                                    <h4 class="font-medium">Điện thoại:</h4>
                                    <p class="text-gray-600">0345672256</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <i data-feather="mail" class="text-red-600 mr-4 mt-1"></i>
                                <div>
                                    <h4 class="font-medium">Email:</h4>
                                    <p class="text-gray-600">kkhanhnguyen2011@gmail.com</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <i data-feather="clock" class="text-red-600 mr-4 mt-1"></i>
                                <div>
                                    <h4 class="font-medium">Giờ làm việc:</h4>
                                    <p class="text-gray-600">Thứ 2 - Thứ CN: 24/7</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="md:w-1/2 md:pl-12" data-aos="fade-left">
                    <form id="contact-form" class="space-y-6">
                        <div>
                            <label for="name" class="block text-gray-700 font-medium mb-2">Họ và tên</label>
                            <input type="text" id="name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600">
                        </div>
                        <div>
                            <label for="email" class="block text-gray-700 font-medium mb-2">Email</label>
                            <input type="email" id="email" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600">
                        </div>
                        <div>
                            <label for="phone" class="block text-gray-700 font-medium mb-2">Điện thoại</label>
                            <input type="tel" id="phone" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600">
                        </div>
                        <div>
                            <label for="message" class="block text-gray-700 font-medium mb-2">Nội dung</label>
                            <textarea id="message" rows="4" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600"></textarea>
                        </div>
                        <button type="submit" class="w-full bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-medium transition duration-300">GỬI LIÊN HỆ</button>
                        <div id="contact-message-box" class="mt-4 text-center hidden"></div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-12">
        <div class="container mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <div class="flex items-center mb-4">
                        <i data-feather="box" class="text-red-600 mr-2"></i>
                        <span class="font-bold text-xl">GẠCH VIP</span>
                    </div>
                    <p class="text-gray-400 mb-4">Chuyên cung cấp các loại gạch ốp lát cao cấp với chất lượng vượt trội và giá cả cạnh tranh.</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white"><i data-feather="facebook"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white"><i data-feather="instagram"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white"><i data-feather="youtube"></i></a>
                        <a href="#" class="text-gray-400 hover:text-white"><i data-feather="twitter"></i></a>
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">DANH MỤC</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white">Gạch lát nền</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Gạch ốp tường</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Gạch trang trí</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Gạch sân vườn</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Gạch phòng tắm</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">HỖ TRỢ</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white">Hướng dẫn mua hàng</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Chính sách bảo hành</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Chính sách đổi trả</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Vận chuyển - Giao nhận</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white">Câu hỏi thường gặp</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">ĐĂNG KÝ NHẬN TIN</h3>
                    <p class="text-gray-400 mb-4">Đăng ký để nhận thông tin khuyến mãi và sản phẩm mới nhất.</p>
                    <form class="flex">
                        <input type="email" placeholder="Email của bạn" class="px-4 py-2 w-full rounded-l-lg focus:outline-none text-gray-800">
                        <button type="submit" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded-r-lg">
                            <i data-feather="send"></i>
                        </button>
                    </form>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-12 pt-8 text-center text-gray-400">
                <p>© 2023 Gạch VIP. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Firebase Scripts -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, setLogLevel, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Set Firebase debug log level
        setLogLevel('debug');
        
        // Firebase config and app ID are provided by the environment
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        
        let db, auth, userId;

        const app = initializeApp(firebaseConfig);
        db = getFirestore(app);
        auth = getAuth(app);
        
        const productsContainer = document.getElementById('products-container');
        const productForm = document.getElementById('add-product-form');
        const productMessageBox = document.getElementById('message-box');
        const contactForm = document.getElementById('contact-form');
        const contactMessageBox = document.getElementById('contact-message-box');
        const userIdDisplay = document.getElementById('user-id-display');
        const userInfoBar = document.getElementById('user-info-bar');
        
        // Render a single product card
        function renderProduct(doc) {
            const data = doc.data();
            const productCard = document.createElement('div');
            productCard.className = 'bg-white rounded-lg overflow-hidden shadow-md product-card transition duration-300';
            
            // Generate a random number of stars for demonstration
            const starCount = Math.floor(Math.random() * 5) + 1;
            const starsHtml = Array(5).fill().map((_, i) => `<i data-feather="star" class="w-4 h-4 ${i < starCount ? 'fill-current text-yellow-400' : ''}"></i>`).join('');

            productCard.innerHTML = `
                <div class="relative overflow-hidden h-64">
                    <img src="${data.imageUrl}" alt="${data.name}" class="w-full h-full object-cover">
                </div>
                <div class="p-6">
                    <h3 class="text-xl font-semibold mb-2">${data.name}</h3>
                    <div class="flex items-center mb-3">
                        <div class="flex">${starsHtml}</div>
                        <span class="text-gray-600 text-sm ml-2">(mới)</span>
                    </div>
                    <p class="text-gray-600 mb-4">${data.description}</p>
                    <div class="flex justify-between items-center">
                        <span class="text-red-600 font-bold text-xl">${data.price.toLocaleString('vi-VN')}đ/m²</span>
                        <button class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition duration-300">
                            <i data-feather="shopping-cart" class="w-4 h-4 inline mr-1"></i> Thêm vào giỏ
                        </button>
                    </div>
                </div>
            `;
            productsContainer.appendChild(productCard);
            feather.replace(); // Re-render icons for new content
        }

        // Listen for new products from the database
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                userId = user.uid;
                userIdDisplay.textContent = `User ID của bạn: ${userId}`;
                userInfoBar.classList.remove('hidden');

                // Get the public products collection
                const productsCollectionRef = collection(db, `artifacts/${appId}/public/data/products`);
                const q = query(productsCollectionRef);

                onSnapshot(q, (snapshot) => {
                    productsContainer.innerHTML = ''; // Clear existing products
                    snapshot.forEach(doc => {
                        renderProduct(doc);
                    });
                }, (error) => {
                    console.error("Error fetching products:", error);
                    showMessage(productMessageBox, "Lỗi: Không thể tải sản phẩm. Vui lòng thử lại sau.", 'text-red-500');
                });

            } else {
                try {
                    if (initialAuthToken) {
                        await signInWithCustomToken(auth, initialAuthToken);
                    } else {
                        await signInAnonymously(auth);
                    }
                } catch (error) {
                    console.error("Firebase Auth Error:", error);
                    showMessage(productMessageBox, "Lỗi xác thực. Một số tính năng có thể không hoạt động.", 'text-red-500');
                }
            }
        });

        // Add a new product to the database
        productForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            showMessage(productMessageBox, "Đang thêm sản phẩm...", 'text-blue-500');

            const name = document.getElementById('productName').value;
            const description = document.getElementById('productDesc').value;
            const price = parseInt(document.getElementById('productPrice').value);
            const imageUrl = document.getElementById('productImage').value;

            if (!name || !description || isNaN(price) || !imageUrl) {
                showMessage(productMessageBox, "Vui lòng điền đầy đủ thông tin.", 'text-red-500');
                return;
            }

            try {
                await addDoc(collection(db, `artifacts/${appId}/public/data/products`), {
                    name,
                    description,
                    price,
                    imageUrl,
                    timestamp: new Date()
                });
                showMessage(productMessageBox, "Sản phẩm đã được thêm thành công!", 'text-green-500');
                productForm.reset();
            } catch (e) {
                console.error("Error adding document: ", e);
                showMessage(productMessageBox, "Đã xảy ra lỗi khi thêm sản phẩm.", 'text-red-500');
            }
        });

        // Add a new contact form submission to the database
        contactForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            showMessage(contactMessageBox, "Đang gửi thông tin...", 'text-blue-500');

            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const message = document.getElementById('message').value;

            if (!name || !email || !phone || !message) {
                showMessage(contactMessageBox, "Vui lòng điền đầy đủ thông tin.", 'text-red-500');
                return;
            }

            try {
                await addDoc(collection(db, `artifacts/${appId}/public/data/contacts`), {
                    name,
                    email,
                    phone,
                    message,
                    timestamp: new Date()
                });
                showMessage(contactMessageBox, "Gửi liên hệ thành công! Chúng tôi sẽ phản hồi sớm nhất.", 'text-green-500');
                // Thêm độ trễ 2 giây trước khi reset form
                setTimeout(() => {
                    contactForm.reset();
                }, 2000); 
            } catch (e) {
                console.error("Error adding contact form submission: ", e);
                showMessage(contactMessageBox, "Đã xảy ra lỗi khi gửi liên hệ.", 'text-red-500');
            }
        });

        function showMessage(element, msg, colorClass) {
            element.textContent = msg;
            element.className = `mt-4 text-center ${colorClass}`;
        }
    </script>
    <script>
        AOS.init({
            duration: 800,
            easing: 'ease-in-out',
            once: true
        });
        feather.replace();
    </script>
</body>
</html>
